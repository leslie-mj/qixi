<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>送你的花</title>
    <script src="https://unpkg.com/css-doodle@0.30.3/css-doodle.min.js"></script>
    <style>
    html,
    body {
        height: 100%;
        margin: 0;
    }

    body {
        display: flex;
        align-items: center;
        justify-content: center;
        background: #1e1e1e;
        position: relative; 
    }

    graph {
        position: relative;
        width: 70vmin;
        height: 100vmin;
        background: #1e1e1e;
    }
    
     .qixi_text {
        position: absolute;
        top: 50%;
        transform: translate(-50%, -50%);
        font-size: 6em;
        font-weight: bold;
        z-index: 10; 
        display: flex;
        gap: 0.2em; 
        pointer-events: none; 
        flex-direction: column;
        flex-wrap: wrap;
        align-content: flex-start;
        justify-content: center;
    }

    .qixi_left{
        left: 30%;
    }

    .qixi_right{
        left: 70%;
    }
    
    .qixi_text span {
        color: var(--text-color, blueviolet); 
        text-shadow: 0 0 10px rgba(255,255,255,0.3);
    }
    </style>
</head>
<body>
    <div class="qixi_text qixi_left">
        <span>七</span>
        <span>夕</span>
    </div>
    
    <style>
    css-doodle {
        --rule: ( :doodle {
            @grid: 200x1 / 70vmin 100vmin;
            overflow: visible;
            contain: initial;
            --colors: @p((#e9dbce, #fceade, #ea526f, #e2c290, #6b2d5c, #25ced1),
                (#c9cba3, #ffe1a8, #e26d5c, #723d46, #472d30),
                (#2B2B2B, #91B3E1, #2F5FB3, #3D4B89, #AE99E8, #DBE2EC),
                (#114b5f, #1a936f, #88d498, #c6dabf, #f3e9d2),
                (#e42268, #fb8075, #761871, #5b7d9c, #a38cb4, #476590),
                (#223843, #e9dbce, #eff1f3, #dbd3d8, #d8b4a0, #d77a61),
                (#e29578, #ffffff, #006d77, #83c5be, #ffddd2, #edf6f9),
                (#ffbe0b, #fb5607, #ff006e, #8338ec, #3a86ff));
            
            /* 定义文字颜色变量 */
            --text-color: @p(--colors);
        }

        position: absolute;

        @keyframes keyframes {
            from { scale: 1; }
            to { scale: 0; }
        }

        @match (i < @p(1, 41)) {
            @size: @r(5, 12)vmin;
            @place: @r(0, 100)% @r(60, 100)%;
            transform: rotate(calc(@p(-90, 90)deg + @r(±30)deg)) skew(@r(20)deg);
            background: linear-gradient(180deg, @p(--colors), @P);
            opacity: @r(0.5, 0.8);
            clip-path: @shape(points: 200;
            a: cos(t)*@r(9, 13)/18 - cos(2t)*5/@r(9, 18);
            b: cos(3t)/@r(10, 18) + cos(3t)/@r(18, 20);
            x: .75 * sin(t - @r(0.1))^3;
            y: a - b + .15;
            );
        }

        @match(i=41) {
            @place: 57% 65%;
            ::after {
                position: absolute;
                left: 0;
                bottom: 0;
                content: "(";
                font-size: 15vmin;
                color: @p(--colors);
                -webkit-text-stroke: 0.2vmin @P();
                transform: rotate(60deg) skew(60deg) scale(1.2, 3);
            }
        }

        @match(i > 41 && i < 60) {
            @size: @r(15, 25)vmin;
            @place: 50% 20%;
            transform: rotate(@r(360)deg) skew(@r(20)deg);
            transform-origin: 50% 85%;
            background: linear-gradient(180deg, @p(--colors), @P);
            opacity: @r(0.2, 1);
            clip-path: @shape(points: 200;
            a: cos(t)*@r(9, 13)/18 - cos(2t)*5/@r(9, 18);
            b: cos(3t)/@r(10, 18) + cos(3t)/@r(18, 20);
            x: .75 * sin(t - @r(0.1))^3;
            y: a - b + .15;
            );
            ::after {
                content: "";
                @size: 100%;
                @place: center;
            }
        }
        )
    }
    </style>
    
    <graph>
        <css-doodle use="var(--rule)" click-to-update>
            :doodle {
            }
        </css-doodle>
    </graph>
    <div class="qixi_text qixi_right">
        <span>快</span>
        <span>乐</span>
    </div>
</body>
<script>
    setInterval(() => {
        // 更新CSS-doodle
        document.querySelector('css-doodle').update();
        
        // 获取CSS-doodle中生成的颜色变量
        const doodle = document.querySelector('css-doodle');
        const computedStyle = window.getComputedStyle(doodle);
        const textColor = computedStyle.getPropertyValue('--text-color').trim();
        
        // 将颜色应用到每个字
        document.querySelectorAll('.qixi_text span').forEach(span => {
            span.style.setProperty('--text-color', textColor);
        });
    }, 700);
</script>
</html>
